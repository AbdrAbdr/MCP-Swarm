# ═══════════════════════════════════════════════════════════════════════════
# MCP Swarm Telegram Bot - Cloudflare Worker (v0.9.17)
# ═══════════════════════════════════════════════════════════════════════════
#
# ИНСТРУКЦИЯ ПО ДЕПЛОЮ:
# 1. Создайте бота через @BotFather в Telegram
# 2. Скопируйте токен бота
# 3. Сначала задеплойте Hub (cloudflare/hub-latest) и скопируйте его URL
# 4. Замените SWARM_HUB_URL ниже на URL вашего Hub
# 5. npx wrangler login
# 6. npx wrangler secret put TELEGRAM_BOT_TOKEN
#    (вставьте токен от BotFather)
# 7. npx wrangler secret put SWARM_AUTH_TOKEN
#    (тот же токен, что в Hub и Server)
# 8. npx wrangler deploy
# 9. Установите webhook:
#    curl "https://mcp-swarm-telegram.<YOUR-SUBDOMAIN>.workers.dev/setup"
#
# ═══════════════════════════════════════════════════════════════════════════

name = "mcp-swarm-telegram"
main = "worker.ts"
compatibility_date = "2024-01-01"

# ═══════════════════════════════════════════════════════════════════════════
# НАСТРОЙКИ - ЗАМЕНИТЕ НА СВОИ!
# ═══════════════════════════════════════════════════════════════════════════
[vars]
# URL вашего Hub (задеплойте сначала cloudflare/hub-latest)
SWARM_HUB_URL = "wss://mcp-swarm-hub.YOUR-SUBDOMAIN.workers.dev/ws"
SWARM_PROJECT = "default"

# ═══════════════════════════════════════════════════════════════════════════
# СЕКРЕТЫ (добавляются через CLI, НЕ здесь!)
# ═══════════════════════════════════════════════════════════════════════════
# npx wrangler secret put TELEGRAM_BOT_TOKEN
# npx wrangler secret put SWARM_AUTH_TOKEN
# ═══════════════════════════════════════════════════════════════════════════

# Durable Object for storing user<->project mappings
[durable_objects]
bindings = [
  { name = "USER_PROJECTS", class_name = "UserProjects" }
]

[[migrations]]
tag = "v1"
new_classes = ["UserProjects"]

# Cron triggers для scheduled handler (P3-11)
[triggers]
crons = ["*/10 * * * *"]  # Каждые 10 минут
