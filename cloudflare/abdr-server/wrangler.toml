# ═══════════════════════════════════════════════════════════════════════════
# abdr-swarm-server - Персональный MCP Server (Streamable HTTP)
# ═══════════════════════════════════════════════════════════════════════════
#
# ДЕПЛОЙ:
# 1. Сначала задеплойте Hub (cloudflare/abdr-hub)
# 2. Скопируйте URL Hub → HUB_URL ниже
# 3. npx wrangler login
# 4. npx wrangler secret put SWARM_AUTH_TOKEN  (тот же токен, что в Hub)
# 5. npx wrangler deploy
# 6. Server: https://abdr-swarm-server.YOUR-SUBDOMAIN.workers.dev/mcp
#
# ═══════════════════════════════════════════════════════════════════════════

name = "abdr-swarm-server"
main = "src/index.ts"
compatibility_date = "2025-12-01"

[durable_objects]
bindings = [
  { name = "MCP_SESSION", class_name = "McpSession" }
]

[[migrations]]
tag = "v1"
new_classes = ["McpSession"]

# ═══════════════════════════════════════════════════════════════════════════
# НАСТРОЙКИ
# ═══════════════════════════════════════════════════════════════════════════
[vars]
HUB_URL = "wss://abdr-swarm-hub.YOUR-SUBDOMAIN.workers.dev/ws"

# ═══════════════════════════════════════════════════════════════════════════
# СЕКРЕТЫ (добавляются через CLI, НЕ здесь!)
# ═══════════════════════════════════════════════════════════════════════════
# npx wrangler secret put SWARM_AUTH_TOKEN
# npx wrangler secret put TELEGRAM_BOT_TOKEN
# npx wrangler secret put TELEGRAM_CHAT_ID
# ═══════════════════════════════════════════════════════════════════════════
